<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Babylon.js Animation Example</title>
    <script src="https://cdn.babylonjs.com/babylon.js"></script>
    <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>
    <style>
        #renderCanvas {
            width: 100%;
            height: 100%;
            touch-action: none;
        }
    </style>
</head>
<body>
    <canvas id="renderCanvas"></canvas>
    <script src="SceneAndMeshLoader.js"></script>
    <script src="AnimationLoader.js"></script>
    <script src="playAnims.js"></script>
    <script src="ScreenRecorder.js"></script>
    <script>
        async function initialize() {
            [scene, engine, loaded] = await createScene(document.getElementById("renderCanvas"));

            // Run the render loop
            engine.runRenderLoop(function () {
                scene.render();
            });

            // Resize the canvas when the window is resized
            window.addEventListener("resize", function () {
                engine.resize();
            });
        }

        initialize().catch(error => {
            console.error('Failed to initialize:', error);
        });

        async function loadAnim(animationName) {
            if (scene && loaded) {
                console.log("Loading animation:", animationName);
                await getAnims(scene, loaded, animationName);
            } else {
                console.error('Scene or loaded variables are not set.');
            }
        }

        async function playLoadedAnims() {
            if (scene && loaded) {
                
                await playAnims(scene, loaded, 0);
            } else {
                console.error('Scene or loaded variables are not set.');
            }
        }


        async function automateAnimations() {
            const animations = ["BACARDI-A.glb", "AAP.glb"];

            for (let i = 0; i < animations.length; i++) {

                console.log("Current animation:", animations[i]); 

                await loadAnim(animations[i]); // Load the current animation
                
                await startRecording('renderCanvas', animations[i]); // Start recording
                console.log("Playing animation:", animations[i]); 
                await playLoadedAnims(); 
                await stopRecording(); // Stop recording after the animation plays
                                
            }
        }


    </script>
    <button onclick="automateAnimations()">Load Animation sequence</button>

</body>
</html>
